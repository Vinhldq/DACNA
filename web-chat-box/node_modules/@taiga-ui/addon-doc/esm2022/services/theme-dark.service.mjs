import { inject, Injectable } from '@angular/core';
import { WA_LOCAL_STORAGE, WA_WINDOW } from '@ng-web-apis/common';
import { tuiCreateToken } from '@taiga-ui/cdk/utils/miscellaneous';
import { TUI_DARK_MODE_DEFAULT_KEY, TUI_DARK_MODE_KEY } from '@taiga-ui/core/tokens';
import { BehaviorSubject } from 'rxjs';
import * as i0 from "@angular/core";
/**
 * @deprecated use {@link TUI_DARK_THEME} instead
 */
export const TUI_DARK_THEME_DEFAULT_KEY = TUI_DARK_MODE_DEFAULT_KEY;
/**
 * @deprecated use {@link TUI_DARK_THEME} instead
 */
export const TUI_DARK_THEME_KEY = TUI_DARK_MODE_KEY;
/**
 * @deprecated use {@link TUI_DARK_THEME} instead
 */
export const TUI_DARK_THEME = tuiCreateToken(false);
/**
 * @deprecated use {@link TUI_DARK_THEME} instead
 */
class TuiDocThemeDarkService extends BehaviorSubject {
    constructor() {
        super(isDark(inject(WA_LOCAL_STORAGE), inject(TUI_DARK_THEME_KEY), inject(WA_WINDOW)));
        this.storage = inject(WA_LOCAL_STORAGE);
        this.key = inject(TUI_DARK_THEME_KEY);
    }
    next(dark) {
        this.storage.setItem(this.key, String(dark));
        super.next(dark);
    }
    toggle() {
        this.next(!this.value);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TuiDocThemeDarkService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TuiDocThemeDarkService, providedIn: 'root' }); }
}
export { TuiDocThemeDarkService };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: TuiDocThemeDarkService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root',
                }]
        }], ctorParameters: function () { return []; } });
function isDark(storage, key, window) {
    const fallback = window.matchMedia('(prefers-color-scheme: dark)').matches ||
        inject(TUI_DARK_THEME);
    return storage.getItem(key) === 'true' || (storage.getItem(key) === null && fallback);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhlbWUtZGFyay5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvYWRkb24tZG9jL3NlcnZpY2VzL3RoZW1lLWRhcmsuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsTUFBTSxFQUFFLFVBQVUsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNqRCxPQUFPLEVBQUMsZ0JBQWdCLEVBQUUsU0FBUyxFQUFDLE1BQU0scUJBQXFCLENBQUM7QUFDaEUsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLG1DQUFtQyxDQUFDO0FBQ2pFLE9BQU8sRUFBQyx5QkFBeUIsRUFBRSxpQkFBaUIsRUFBQyxNQUFNLHVCQUF1QixDQUFDO0FBQ25GLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxNQUFNLENBQUM7O0FBRXJDOztHQUVHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sMEJBQTBCLEdBQUcseUJBQXlCLENBQUM7QUFFcEU7O0dBRUc7QUFDSCxNQUFNLENBQUMsTUFBTSxrQkFBa0IsR0FBRyxpQkFBaUIsQ0FBQztBQUVwRDs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBRyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7QUFFcEQ7O0dBRUc7QUFDSCxNQUdhLHNCQUF1QixTQUFRLGVBQXdCO0lBSWhFO1FBQ0ksS0FBSyxDQUNELE1BQU0sQ0FDRixNQUFNLENBQUMsZ0JBQWdCLENBQUMsRUFDeEIsTUFBTSxDQUFDLGtCQUFrQixDQUFDLEVBQzFCLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FDcEIsQ0FDSixDQUFDO1FBVlcsWUFBTyxHQUFHLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ25DLFFBQUcsR0FBRyxNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQztJQVVsRCxDQUFDO0lBRWUsSUFBSSxDQUFDLElBQWE7UUFDOUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUM3QyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3JCLENBQUM7SUFFTSxNQUFNO1FBQ1QsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMzQixDQUFDOytHQXJCUSxzQkFBc0I7bUhBQXRCLHNCQUFzQixjQUZuQixNQUFNOztTQUVULHNCQUFzQjs0RkFBdEIsc0JBQXNCO2tCQUhsQyxVQUFVO21CQUFDO29CQUNSLFVBQVUsRUFBRSxNQUFNO2lCQUNyQjs7QUF5QkQsU0FBUyxNQUFNLENBQUMsT0FBZ0IsRUFBRSxHQUFXLEVBQUUsTUFBYztJQUN6RCxNQUFNLFFBQVEsR0FDVixNQUFNLENBQUMsVUFBVSxDQUFDLDhCQUE4QixDQUFDLENBQUMsT0FBTztRQUN6RCxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUM7SUFFM0IsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssSUFBSSxJQUFJLFFBQVEsQ0FBQyxDQUFDO0FBQzFGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2luamVjdCwgSW5qZWN0YWJsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1dBX0xPQ0FMX1NUT1JBR0UsIFdBX1dJTkRPV30gZnJvbSAnQG5nLXdlYi1hcGlzL2NvbW1vbic7XG5pbXBvcnQge3R1aUNyZWF0ZVRva2VufSBmcm9tICdAdGFpZ2EtdWkvY2RrL3V0aWxzL21pc2NlbGxhbmVvdXMnO1xuaW1wb3J0IHtUVUlfREFSS19NT0RFX0RFRkFVTFRfS0VZLCBUVUlfREFSS19NT0RFX0tFWX0gZnJvbSAnQHRhaWdhLXVpL2NvcmUvdG9rZW5zJztcbmltcG9ydCB7QmVoYXZpb3JTdWJqZWN0fSBmcm9tICdyeGpzJztcblxuLyoqXG4gKiBAZGVwcmVjYXRlZCB1c2Uge0BsaW5rIFRVSV9EQVJLX1RIRU1FfSBpbnN0ZWFkXG4gKi9cbmV4cG9ydCBjb25zdCBUVUlfREFSS19USEVNRV9ERUZBVUxUX0tFWSA9IFRVSV9EQVJLX01PREVfREVGQVVMVF9LRVk7XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgdXNlIHtAbGluayBUVUlfREFSS19USEVNRX0gaW5zdGVhZFxuICovXG5leHBvcnQgY29uc3QgVFVJX0RBUktfVEhFTUVfS0VZID0gVFVJX0RBUktfTU9ERV9LRVk7XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgdXNlIHtAbGluayBUVUlfREFSS19USEVNRX0gaW5zdGVhZFxuICovXG5leHBvcnQgY29uc3QgVFVJX0RBUktfVEhFTUUgPSB0dWlDcmVhdGVUb2tlbihmYWxzZSk7XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgdXNlIHtAbGluayBUVUlfREFSS19USEVNRX0gaW5zdGVhZFxuICovXG5ASW5qZWN0YWJsZSh7XG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxufSlcbmV4cG9ydCBjbGFzcyBUdWlEb2NUaGVtZURhcmtTZXJ2aWNlIGV4dGVuZHMgQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+IHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHN0b3JhZ2UgPSBpbmplY3QoV0FfTE9DQUxfU1RPUkFHRSk7XG4gICAgcHJpdmF0ZSByZWFkb25seSBrZXkgPSBpbmplY3QoVFVJX0RBUktfVEhFTUVfS0VZKTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihcbiAgICAgICAgICAgIGlzRGFyayhcbiAgICAgICAgICAgICAgICBpbmplY3QoV0FfTE9DQUxfU1RPUkFHRSksXG4gICAgICAgICAgICAgICAgaW5qZWN0KFRVSV9EQVJLX1RIRU1FX0tFWSksXG4gICAgICAgICAgICAgICAgaW5qZWN0KFdBX1dJTkRPVyksXG4gICAgICAgICAgICApLFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBvdmVycmlkZSBuZXh0KGRhcms6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0odGhpcy5rZXksIFN0cmluZyhkYXJrKSk7XG4gICAgICAgIHN1cGVyLm5leHQoZGFyayk7XG4gICAgfVxuXG4gICAgcHVibGljIHRvZ2dsZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5uZXh0KCF0aGlzLnZhbHVlKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGlzRGFyayhzdG9yYWdlOiBTdG9yYWdlLCBrZXk6IHN0cmluZywgd2luZG93OiBXaW5kb3cpOiBib29sZWFuIHtcbiAgICBjb25zdCBmYWxsYmFjayA9XG4gICAgICAgIHdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJykubWF0Y2hlcyB8fFxuICAgICAgICBpbmplY3QoVFVJX0RBUktfVEhFTUUpO1xuXG4gICAgcmV0dXJuIHN0b3JhZ2UuZ2V0SXRlbShrZXkpID09PSAndHJ1ZScgfHwgKHN0b3JhZ2UuZ2V0SXRlbShrZXkpID09PSBudWxsICYmIGZhbGxiYWNrKTtcbn1cbiJdfQ==