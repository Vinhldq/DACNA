const IFRAME = 'position: fixed; visibility: hidden; pointer-events: none';
const BODY = 'height: fit-content; line-height: 1em;';
export function tuiFontSizeWatcher(callback, win = window) {
    const iframe = win.document.createElement('iframe');
    const resize = () => {
        const { innerWidth, outerWidth, devicePixelRatio } = win;
        iframe.width = `${innerWidth === outerWidth ? innerWidth : innerWidth / devicePixelRatio}`;
    };
    win.document.body.append(iframe);
    win.addEventListener('resize', resize);
    const doc = iframe.contentWindow?.document;
    const observer = new ResizeObserver(() => callback(doc?.body.offsetHeight || 0));
    iframe.setAttribute('style', IFRAME);
    doc?.documentElement.style.setProperty('font', '-apple-system-body');
    doc?.body.setAttribute('style', BODY);
    doc?.body.insertAdjacentText('beforeend', '.'.repeat(1000));
    observer.observe(doc?.body || iframe);
    resize();
    return () => {
        observer.disconnect();
        iframe.remove();
        win.removeEventListener('resize', resize);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9udC1zaXplLXdhdGNoZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jZGsvdXRpbHMvbWlzY2VsbGFuZW91cy9mb250LXNpemUtd2F0Y2hlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLE1BQU0sR0FBRywyREFBMkQsQ0FBQztBQUMzRSxNQUFNLElBQUksR0FBRyx3Q0FBd0MsQ0FBQztBQUV0RCxNQUFNLFVBQVUsa0JBQWtCLENBQzlCLFFBQW9DLEVBQ3BDLE1BQWMsTUFBTTtJQUVwQixNQUFNLE1BQU0sR0FBRyxHQUFHLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNwRCxNQUFNLE1BQU0sR0FBRyxHQUFTLEVBQUU7UUFDdEIsTUFBTSxFQUFDLFVBQVUsRUFBRSxVQUFVLEVBQUUsZ0JBQWdCLEVBQUMsR0FBRyxHQUFHLENBQUM7UUFFdkQsTUFBTSxDQUFDLEtBQUssR0FBRyxHQUFHLFVBQVUsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsVUFBVSxHQUFHLGdCQUFnQixFQUFFLENBQUM7SUFDL0YsQ0FBQyxDQUFDO0lBRUYsR0FBRyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2pDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFFdkMsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLGFBQWEsRUFBRSxRQUFRLENBQUM7SUFDM0MsTUFBTSxRQUFRLEdBQUcsSUFBSSxjQUFjLENBQUMsR0FBRyxFQUFFLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsWUFBWSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFakYsTUFBTSxDQUFDLFlBQVksQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDckMsR0FBRyxFQUFFLGVBQWUsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxvQkFBb0IsQ0FBQyxDQUFDO0lBQ3JFLEdBQUcsRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN0QyxHQUFHLEVBQUUsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDNUQsUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsSUFBSSxJQUFJLE1BQU0sQ0FBQyxDQUFDO0lBQ3RDLE1BQU0sRUFBRSxDQUFDO0lBRVQsT0FBTyxHQUFHLEVBQUU7UUFDUixRQUFRLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDdEIsTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ2hCLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDOUMsQ0FBQyxDQUFDO0FBQ04sQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IElGUkFNRSA9ICdwb3NpdGlvbjogZml4ZWQ7IHZpc2liaWxpdHk6IGhpZGRlbjsgcG9pbnRlci1ldmVudHM6IG5vbmUnO1xuY29uc3QgQk9EWSA9ICdoZWlnaHQ6IGZpdC1jb250ZW50OyBsaW5lLWhlaWdodDogMWVtOyc7XG5cbmV4cG9ydCBmdW5jdGlvbiB0dWlGb250U2l6ZVdhdGNoZXIoXG4gICAgY2FsbGJhY2s6IChmb250U2l6ZTogbnVtYmVyKSA9PiB2b2lkLFxuICAgIHdpbjogV2luZG93ID0gd2luZG93LFxuKTogKCkgPT4gdm9pZCB7XG4gICAgY29uc3QgaWZyYW1lID0gd2luLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpO1xuICAgIGNvbnN0IHJlc2l6ZSA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgY29uc3Qge2lubmVyV2lkdGgsIG91dGVyV2lkdGgsIGRldmljZVBpeGVsUmF0aW99ID0gd2luO1xuXG4gICAgICAgIGlmcmFtZS53aWR0aCA9IGAke2lubmVyV2lkdGggPT09IG91dGVyV2lkdGggPyBpbm5lcldpZHRoIDogaW5uZXJXaWR0aCAvIGRldmljZVBpeGVsUmF0aW99YDtcbiAgICB9O1xuXG4gICAgd2luLmRvY3VtZW50LmJvZHkuYXBwZW5kKGlmcmFtZSk7XG4gICAgd2luLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc2l6ZSk7XG5cbiAgICBjb25zdCBkb2MgPSBpZnJhbWUuY29udGVudFdpbmRvdz8uZG9jdW1lbnQ7XG4gICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKCkgPT4gY2FsbGJhY2soZG9jPy5ib2R5Lm9mZnNldEhlaWdodCB8fCAwKSk7XG5cbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdzdHlsZScsIElGUkFNRSk7XG4gICAgZG9jPy5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJ2ZvbnQnLCAnLWFwcGxlLXN5c3RlbS1ib2R5Jyk7XG4gICAgZG9jPy5ib2R5LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBCT0RZKTtcbiAgICBkb2M/LmJvZHkuaW5zZXJ0QWRqYWNlbnRUZXh0KCdiZWZvcmVlbmQnLCAnLicucmVwZWF0KDEwMDApKTtcbiAgICBvYnNlcnZlci5vYnNlcnZlKGRvYz8uYm9keSB8fCBpZnJhbWUpO1xuICAgIHJlc2l6ZSgpO1xuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICBpZnJhbWUucmVtb3ZlKCk7XG4gICAgICAgIHdpbi5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemUpO1xuICAgIH07XG59XG4iXX0=